<!DOCTYPE = HTML>
<html>
	<head>
		<style>
			canvas {

				background-color : #f0f8ff;
			}
		</style>
		<title>
			statistics with closures
		</title>
		<script src="arr.js" type="text/javascript">
		</script>
		<script src="stat.js" type="text/javascript">
		</script>
	</head>
	<body>

		<p id='text'>
			text:
		</p>

		<script type="text/javascript">

			function pr ( p_text ) { console.log ( p_text ); }

			var
			dx  = .1,
			x   = seq ( -100, +101, pol ( [ 0, dx ] ) );
			p   = fun ( pnorm ( 1, 2, dx ), x ),
			d   = fun ( dnorm ( 1, 2 ), x );

			pr ( cum ( rAdd, p ) );
			pr ( expVal ( x, p ) );
			pr ( variance ( x, p ) );
			pr ( sigma ( x, p ) );

			pr ( dx * cum ( rAdd, d ) );
			pr ( dx * expVal ( x, d ) );
			pr ( dx * variance ( x, d ) );
			pr ( dx * sigma ( x, d ) );

			var
			z = rel ( rDiv, rel ( rSub, x, expVal ( x, p ) ), sigma ( x, p ) );

			pr ( expVal ( z, p ) );
			pr ( variance ( z, p ) );
			pr ( sigma ( z, p ) );

			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, -1 ), x ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, -1 ), x ), p ) ) );
			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 3 ), x ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 3 ), x ), p ) ) );

			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1, 3 ), x ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -1, 3 ), x ), p ) ) );

			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1, 1 ), z ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -1, 1 ), z ), p ) ) );

			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -2, 2 ), z ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -3, 3 ), z ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -4, 4 ), z ), p ) ) );
			pr ( 1 - cum ( rAdd, rel ( rMul, fun ( rng ( -5, 5 ), z ), p ) ) );

			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 1 ), x ), p ) ) );
			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( 1, 1e12 ), x ), p ) ) );
			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 1 ), x ), p ) ) + cum ( rAdd, rel ( rMul, fun ( rng ( 1, 1e12 ), x ), p ) ) );

			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 0 ), z ), p ) ) );
			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( 0, 1e12 ), z ), p ) ) );
			pr ( cum ( rAdd, rel ( rMul, fun ( rng ( -1e12, 0 ), z ), p ) ) + cum ( rAdd, rel ( rMul, fun ( rng ( 0, 1e12 ), z ), p ) ) );

			pr ( cum ( rAdd, p ) );
			pr ( cum ( rAdd, d ) );

			var
			i = fun ( int( ), p );

			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .1 ), i ) ) ] );
			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .9 ), i ) ) ] );
			pr ( -x[ cum ( rAdd, fun ( rng ( -1e22, .1 ), i ) ) ] + x[ cum ( rAdd, fun ( rng ( -1e22, .9 ), i ) ) ] );

			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .025 ), i ) ) ] );
			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .975 ), i ) ) ] );
			pr ( -x[ cum ( rAdd, fun ( rng ( -1e22, .025 ), i ) ) ] + x[ cum ( rAdd, fun ( rng ( -1e22, .975 ), i ) ) ] );

			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .01 ), i ) ) ] );
			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .99 ), i ) ) ] );
			pr ( -x[ cum ( rAdd, fun ( rng ( -1e22, .01 ), i ) ) ] + x[ cum ( rAdd, fun ( rng ( -1e22, .99 ), i ) ) ] );

			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .001 ), i ) ) ] );
			pr ( x[ cum ( rAdd, fun ( rng ( -1e22, .999 ), i ) ) ] );
			pr ( -x[ cum ( rAdd, fun ( rng ( -1e22, .001 ), i ) ) ] + x[ cum ( rAdd, fun ( rng ( -1e22, .999 ), i ) ) ] );

		</script>

	</body>
</html>
