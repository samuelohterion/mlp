<!DOCTYPE = HTML>
<html>

	<head>

		<style>

		</style>

		<title>

			arr.example

		</title>

		<script type="text/javascript">

			function arr ( pI_size, pFct_fct = cst ( 0 ), r = [ ] ) {

				for ( var i = 0; i < pI_size; ++ i )

					r[ i ] = pFct_fct ( i );

				return r;
			}

			function seq ( pI_begin, pI_end, pFct_fct = add ( 0 ), r = [ ] ) {

				for ( var i = pI_begin; i < pI_end; ++ i )

					r[ i - pI_begin ] = pFct_fct ( i );

				return r;
			}

			function fun ( pFct_fct, pA_src, pA_dst = [ ] ) {

				for ( var i = 0; i < pA_src.length; ++ i )

					pA_dst[ i ] = pFct_fct ( pA_src[ i ] );

				return pA_dst;
			}

			function rel ( pFct_fct, pA_src1, pA_src2, pA_dst = [ ] ) {

				for ( var i = 0; i < pA_src1.length; ++ i )

					pA_dst[ i ] = pFct_fct( pA_src1[ i ], pA_src2[ i ] );

				return pA_dst;
			}

			function cum ( pFct_fct, pA_src, r = pA_src[ 0 ] ) {

				var
				i = 0;

				while ( ++ i < pA_src.length )

					r = pFct_fct( r, pA_src[ i ] );

				return r;
			}

		</script>

	</head>

	<body>

		<script type="text/javascript">

			function cst ( p_val ) {

				return function ( i ) {

					return p_val;
				};
			}

			function add ( p_val ) {

				return function ( i ) {

					return p_val + i;
				};
			}

			function pol ( pA_coeff ) {

				return function ( x ) {

					var
					r = 0,
					e = -1,
					p = 1;

					while ( ++ e < pA_coeff.length ) {

						r += pA_coeff[ e ] * p;
						p *= x;
					}

					return r;
				};
			}

			function pr ( p_text ) { console.log ( p_text ); }

			function sSet ( a ) { return a; }

			function sSqr ( a ) { return a * a; }

			function rMul ( a, b ) { return a * b; }

			function rAdd ( a, b ) { return a + b; }

			function round ( a, b = 2 ) { return Math.pow( 10, -b ) * Math.round ( a * Math.pow ( 10, b ) ); }

			var
			u  = arr ( 1e6, add ( 0 ) ),
			v  = arr ( 1e6, cst ( 2 ) ),
			t0 = ( new Date ( ) ).getTime ( ),
			w  = fun ( sSqr, u ),
			t1 = ( new Date ( ) ).getTime ( );

			fun ( sSqr, u, v );

			var
			t2 = ( new Date ( ) ).getTime ( ),
			w  = rel ( rMul, u, v ),
			t3 = ( new Date ( ) ).getTime ( );

			rel ( rMul, u, v, w );

			var
			t4 = ( new Date ( ) ).getTime ( ),
			s0 = cum ( rAdd, rel ( rMul, u, v ) ),
			t5 = ( new Date ( ) ).getTime ( ),
			s1 = cum ( rAdd, rel ( rMul, u, v, w ) ),
			t6 = ( new Date ( ) ).getTime ( );

			alert (
				"dt10: " + ( t1 - t0 ) + "ms\ndt21: " + ( t2 - t1 ) +"ms\n" + round( ( t1 - t0 ) / ( t2 - t1 ) - 1, 2 ) + " x times faster\n" +
				"dt32: " + ( t3 - t2 ) + "ms\ndt43: " + ( t4 - t3 ) +"ms\n" + round( ( t3 - t2 ) / ( t4 - t3 ) - 1, 2 ) + " x times faster\n" +
				"dt54: " + ( t5 - t4 ) + "ms\ndt65: " + ( t6 - t5 ) +"ms\n" + round( ( t5 - t4 ) / ( t6 - t5 ) - 1, 2 ) + " x times faster\n" );

			for ( var loop = 0; loop < 1; ++ loop ) {

				t0 = ( new Date ( ) ).getTime ( );
				w  = fun ( sSqr, u );
				t1 = ( new Date ( ) ).getTime ( );

				fun ( sSqr, u, v );

				t2 = ( new Date ( ) ).getTime ( );
				w  = rel ( rMul, u, v );
				t3 = ( new Date ( ) ).getTime ( );

				rel ( rMul, u, v, w );

				t4 = ( new Date ( ) ).getTime ( );
				s0 = cum ( rAdd, rel ( rMul, u, v ) );
				t5 = ( new Date ( ) ).getTime ( );
				cum ( rAdd, rel ( rMul, u, v, w ), s1 );
				t6 = ( new Date ( ) ).getTime ( );

				alert (
					"dt10: " + ( t1 - t0 ) + "ms\ndt21: " + ( t2 - t1 ) +"ms\n" + round( ( t1 - t0 ) / ( t2 - t1 ) - 1, 2 ) + " x times faster\n" +
					"dt32: " + ( t3 - t2 ) + "ms\ndt43: " + ( t4 - t3 ) +"ms\n" + round( ( t3 - t2 ) / ( t4 - t3 ) - 1, 2 ) + " x times faster\n" +
					"dt54: " + ( t5 - t4 ) + "ms\ndt65: " + ( t6 - t5 ) +"ms\n" + round( ( t5 - t4 ) / ( t6 - t5 ) - 1, 2 ) + " x times faster\n" );

				pr ( w );

				// factorial of 5
				pr ( cum ( rMul, seq( 5, add ( 1 ) ) ) );

				// sum of first 5 squares
				pr ( cum ( rAdd, fun( sSqr, arr ( 5, add ( 1 ) ) ) ) );
				pr ( cum ( rAdd, fun( sSqr, seq ( 1, 6 ) ) ) );
				pr ( cum ( rAdd, seq ( 1, 6, sSqr ) ) );

				pr ( seq ( 0, 21, pol ( [ +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ +1, +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ +1, +2, +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ +1, +3, +3, +1 ] ) ) );
				pr ( seq ( 1, 22, pol ( [ +0, +0, +0, +1 ] ) ) );
				pr ( seq ( 1, 21, pol ( [ +1, +3, +3, +1 ] ) ) );
				pr ( seq ( 2, 23, pol ( [ +0, +0, +0, +1 ] ) ) );

				pr ( seq ( 0, 21, pol ( [ +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ -1, +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ +1, -2, +1 ] ) ) );
				pr ( seq ( 0, 21, pol ( [ -1, +3, -3, +1 ] ) ) );
				pr ( seq ( 1, 22, pol ( [ +0, +0, +0, +1 ] ) ) );
				pr ( seq ( 1, 21, pol ( [ -1, +3, -3, +1 ] ) ) );
				pr ( seq ( 2, 23, pol ( [ +0, +0, +0, +1 ] ) ) );
			}

			u = seq ( 1, 4 );
			v = arr ( 3, cst( 1 ) );
			w = rel ( rAdd, u, v );

			pr ( u );
			pr ( v );
			pr ( w );

			fun ( sSqr, u, u );
			pr ( u );

			s0 = cum ( rAdd, fun ( sSqr, w ) );
			pr ( s0 );

			cum ( rAdd, fun ( sSqr, w ) );
			pr ( s0 );

			arr ( 1e1, cst ( 3 ), u );
			pr ( u );

			arr ( 1e1, add ( 5 ), v );
			pr ( v );

			arr ( 1e1, pol ( [ 3 ] ), w );
			pr ( w );

			arr ( 1e1, pol ( [ 5, 1 ] ), w );
			pr ( w );


			seq( -100, +101, pol ( [ 0, .01 ] ), w );
			pr ( w );

			w = fun ( function ( x ) { return Math.cos ( x ); }, seq( -314, +314, pol ( [ 0, .02 ] ) ) );
			pr ( w );

			var
			m = arr (
				4,
				function ( x ) {

					return arr (

						3,
						function ( y ) {

							return ( x - 1 ) * ( y + 1 );
						}
					)
				}
			);

			pr ( m );

		</script>

	</body>

</html>
